<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="Tech | How to reengineer a word by Java" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Wenjing | è®°å½•</title>

    
        
            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/reset.css">

            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/markdown.css">

            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/fonts.css">
 
            <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
            
        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Wenjing</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/tech/">tech</a></li>
            
        
            
                <li><a href="/biomed/">biomed</a></li>
            
        
            
                <li><a href="/daily/">daily</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Tech | How to reengineer a word by Java
        </div>
      
    

    <div class="post-md">
        
            <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%97%A0%E4%B8%AD%E7%94%9F%E6%9C%89"><span class="post-toc-text">æ— ä¸­ç”Ÿæœ‰</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%A8%A1%E6%9D%BF%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84Word"><span class="post-toc-text">åŸºäºæ¨¡æ¿ç”Ÿæˆæ–°çš„Word</span></a></li></ol>
        
        <p>ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªtaskï¼Œæ˜¯ç”ŸæˆWordã€‚åœ¨æ¥åˆ°è¿™ä¸ªå·¥ä½œçš„æ—¶å€™ï¼Œæˆ‘åœ¨è®¤çŸ¥ä¸Šéå¸¸æ‡µï¼Œå†™ä»£ç æ— éæ˜¯CRUDï¼Œæ€ä¹ˆå¯ä»¥ç”Ÿæˆåˆ›é€ ã€‚æ‰€ä»¥è¿™ä¸ªè§£å†³è¿™ä¸ªtaskçš„é¦–è¦é—®é¢˜æ˜¯è®¤è¯†åˆ°Javaé¡¹ç›®å¯ä»¥åˆ›å»ºæ–°çš„Wordæ–‡æ¡£ã€å¤„ç†å’Œä¿®æ”¹docxæ–‡ä»¶ã€‚è€Œåœ¨å®é™…çš„å·¥ä½œä¸­ï¼ŒåŸºäºå•è¡Œè®°å½•ä¾æ¬¡ç”Ÿæˆå›ºå®šæ¨¡å¼çš„docxæ˜¯ä¸ç†æƒ³çš„ï¼Œå±äºæ˜¯ä¸€ä¸ªæµç¨‹ä»å¤´åˆ°å°¾è·‘äº†å¾ˆå¤šéã€‚åœ¨é¡¹ç›®ä¸­ï¼Œå¯è¡Œçš„æ–¹æ¡ˆæ˜¯åŸºäºæ¨¡æ¿å’Œæ•°æ®ï¼Œä¸æ–­åˆ·æ–°ä¿®æ”¹æ¨¡æ¿ç”Ÿæˆdocxæ–‡ä»¶ã€‚</p>
<h4 id="æ— ä¸­ç”Ÿæœ‰"><a href="#æ— ä¸­ç”Ÿæœ‰" class="headerlink" title="æ— ä¸­ç”Ÿæœ‰"></a>æ— ä¸­ç”Ÿæœ‰</h4><p>åˆ›å»ºä¸€ä¸ªç©ºç™½çš„æ–‡æ¡£å¹¶ä¿å­˜ä¸ºâ€™.docxâ€™æ–‡ä»¶</p>
<pre><code class="java">import org.apache.poi.xwpf.usermodel.*;

import java.io.FileOutputStream;

public class CreateWordDocumentExample &#123;
    public static void main(String[] args) &#123;
        // åˆ›å»ºä¸€ä¸ªç©ºç™½çš„ Word æ–‡æ¡£
        XWPFDocument document = new XWPFDocument();

        // åˆ›å»ºä¸€ä¸ªæ®µè½
        XWPFParagraph paragraph = document.createParagraph();

        // åˆ›å»ºä¸€ä¸ªè¿è¡Œå…ƒç´ ï¼ˆRunï¼‰ï¼Œå¹¶åœ¨æ®µè½ä¸­æ·»åŠ æ–‡æœ¬
        XWPFRun run = paragraph.createRun();
        run.setText(&quot;Hello, World!&quot;);

        try &#123;
            // ä¿å­˜æ–‡æ¡£ä¸º .docx æ–‡ä»¶
            FileOutputStream out = new FileOutputStream(&quot;output.docx&quot;);
            document.write(out);
            out.close();

            System.out.println(&quot;Word æ–‡æ¡£åˆ›å»ºæˆåŠŸï¼&quot;);
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;
&#125;
</code></pre>
<h4 id="åŸºäºæ¨¡æ¿ç”Ÿæˆæ–°çš„Word"><a href="#åŸºäºæ¨¡æ¿ç”Ÿæˆæ–°çš„Word" class="headerlink" title="åŸºäºæ¨¡æ¿ç”Ÿæˆæ–°çš„Word"></a>åŸºäºæ¨¡æ¿ç”Ÿæˆæ–°çš„Word</h4><ul>
<li><p>åˆ›å»ºä¸€ä¸ªWordæ¨¡æ¿ï¼Œå¹¶åœ¨æ¨¡æ¿ä¸Šæ·»åŠ å ä½ç¬¦ï¼Œä½¿ç”¨ä½œä¸ºå ä½ç¬¦çš„æ ¼å¼</p>
<p><img src="https://raw.githubusercontent.com/wenjinglee1104/blog_file/master/image20230614pic01.png" alt="img"></p>
</li>
<li><p>è£… Apache POI åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå¤„ç† Microsoft Office æ–‡æ¡£çš„ Java åº“ã€‚åœ¨é¡¹ç›®ä¸­æ·»åŠ ä»¥ä¸‹ Maven ä¾èµ–é¡¹</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi&lt;/artifactId&gt;
    &lt;version&gt;4.1.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
    &lt;version&gt;4.1.2&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li><p>ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥æ›¿æ¢æ¨¡æ¿ä¸­çš„å ä½ç¬¦å¹¶ç”Ÿæˆæ–°çš„ Word æ–‡æ¡£</p>
<pre><code class="java">import org.apache.poi.xwpf.usermodel.*;
import java.io.*;

public class WordTemplateProcessor &#123;
    public static void main(String[] args) &#123;
        String templatePath = &quot;path/to/your/template.docx&quot;;
        String outputPath = &quot;path/to/output.docx&quot;;

        try &#123;
            // åŠ è½½æ¨¡æ¿æ–‡ä»¶
            FileInputStream fis = new FileInputStream(templatePath);
            XWPFDocument doc = new XWPFDocument(fis);

            // æ›¿æ¢å ä½ç¬¦
            replacePlaceholder(doc, &quot;&#123;&#123;name&#125;&#125;&quot;, &quot;Fredo&quot;);
            
            // æ·»åŠ æ›´å¤šçš„æ›¿æ¢æ“ä½œ...

            // ä¿å­˜ç”Ÿæˆçš„ Word æ–‡æ¡£
            FileOutputStream fos = new FileOutputStream(outputPath);
            doc.write(fos);
            fos.close();
            doc.close();

            System.out.println(&quot;ç”ŸæˆæˆåŠŸï¼&quot;);
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;

    private static void replacePlaceholder(XWPFDocument doc, String placeholder, String replacement) &#123;
        for (XWPFParagraph paragraph : doc.getParagraphs()) &#123;
            for (XWPFRun run : paragraph.getRuns()) &#123;
                String text = run.getText(0);
                if (text != null &amp;&amp; text.contains(placeholder)) &#123;
                    text = text.replace(placeholder, replacement);
                    run.setText(text, 0);
                &#125;
            &#125;
        &#125;
        for (XWPFTable table : doc.getTables()) &#123;
            for (XWPFTableRow row : table.getRows()) &#123;
                for (XWPFTableCell cell : row.getTableCells()) &#123;
                    for (XWPFParagraph paragraph : cell.getParagraphs()) &#123;
                        for (XWPFRun run : paragraph.getRuns()) &#123;
                            String text = run.getText(0);
                            if (text != null &amp;&amp; text.contains(placeholder)) &#123;
                                text = text.replace(placeholder, replacement);
                                run.setText(text, 0);
                            &#125;
                        &#125;
                    &#125;
                &#125;
            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<p>åœ¨ä»£ç ä¸­ï¼Œå°† <code>templatePath</code> æ›¿æ¢ä¸ºæ¨¡æ¿æ–‡ä»¶çš„è·¯å¾„ï¼Œå°† <code>outputPath</code> æ›¿æ¢ä¸ºç”Ÿæˆçš„ Word æ–‡æ¡£çš„è·¯å¾„ã€‚ç„¶åï¼Œä½¿ç”¨ <code>replacePlaceholder</code> æ–¹æ³•æ¥æ›¿æ¢å ä½ç¬¦ã€‚</p>
</li>
<li><p>è¿è¡Œç¨‹åºåï¼Œå®ƒå°†è¯»å–æ¨¡æ¿æ–‡ä»¶ï¼Œæ›¿æ¢å ä½ç¬¦ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„ Word æ–‡æ¡£ã€‚</p>
<p><img src="https://raw.githubusercontent.com/wenjinglee1104/blog_file/master/image20230614pic02.png" alt="img"></p>
</li>
</ul>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-06-14</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« LiWenjing</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/Tech/'>
                            Tech
                        </a>
                    
                </span>
             
             
        
        </i>
    </div>
    
        

     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â© 1949-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠä¸€ç™¾å¹´åæ²¡æœ‰ä½ ä¹Ÿæ²¡æœ‰æˆ‘ğŸŒŠ</span>
            
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            
    
</div>


    
        
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/a11y-dark.min.css">

        
<script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlight.min.js"></script>

        
<script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js"></script>

    


<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>