<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="Tech | how to generate QR codes" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Wenjing | è®°å½•</title>

    
        
            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/reset.css">

            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/markdown.css">

            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/fonts.css">
 
            <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
            
        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Wenjing</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/tech/">tech</a></li>
            
        
            
                <li><a href="/biomed/">biomed</a></li>
            
        
            
                <li><a href="/daily/">daily</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Tech | how to generate QR codes
        </div>
      
    

    <div class="post-md">
        
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ZXing"><span class="post-toc-text">ZXing</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%94%9F%E6%88%90%E4%BA%8C%E7%BB%B4%E7%A0%81%E5%9B%BE%E7%89%87"><span class="post-toc-text">ç”ŸæˆäºŒç»´ç å›¾ç‰‡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%94%9F%E6%88%90%E4%BA%8C%E7%BB%B4%E7%A0%81%E5%B9%B6%E6%8F%92%E5%85%A5word"><span class="post-toc-text">ç”ŸæˆäºŒç»´ç å¹¶æ’å…¥word</span></a></li></ol></li></ol>
        
        <p>å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜æ˜¯ç”ŸæˆäºŒç»´ç å¹¶ä¸”æ’å…¥åˆ°Wordä¸­ï¼Œæ‰€ä»¥æœ¬æ–‡æµ…æµ…å†™ä¸€ä¸‹ç”ŸæˆäºŒç»´ç çš„åº“å’Œç”Ÿæˆçš„è¿‡ç¨‹ã€‚</p>
<h2 id="ZXing"><a href="#ZXing" class="headerlink" title="ZXing"></a>ZXing</h2><h3 id="ç”ŸæˆäºŒç»´ç å›¾ç‰‡"><a href="#ç”ŸæˆäºŒç»´ç å›¾ç‰‡" class="headerlink" title="ç”ŸæˆäºŒç»´ç å›¾ç‰‡"></a>ç”ŸæˆäºŒç»´ç å›¾ç‰‡</h3><p>Google ZXingï¼ˆZebra Crossingï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„æ¡ç å’ŒäºŒç»´ç å¤„ç†åº“ï¼Œç”¨äºåœ¨å„ç§å¹³å°ä¸Šè§£ç å’Œç”Ÿæˆæ¡ç å’ŒäºŒç»´ç ã€‚å®ƒå…·æœ‰å¹¿æ³›çš„ç”¨é€”å’Œåº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼šæ¡ç æ‰«æåº”ç”¨ã€äºŒç»´ç ç”Ÿæˆå’Œè§£ç ã€ç§»åŠ¨æ”¯ä»˜ã€ç”µå­ç¥¨åŠ¡å’Œç™»æœºç‰Œã€åº”ç”¨ä¸‹è½½å’Œæ¨å¹¿ã€‚</p>
<pre><code class="java">//å¯¼å…¥ç›¸åº”çš„ä¾èµ–åº“
import com.google.zxing.BarcodeFormat;
import com.google.zxing.EncodeHintType;
import com.google.zxing.MultiFormatWriter;
import com.google.zxing.common.BitMatrix;
import com.google.zxing.qrcode.decoder.ErrorCorrectionLevel;
import javax.imageio.ImageIO;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

//å°†è¿™æ®µä»£ç æ”¾åœ¨é€‚å½“çš„ç±»æ–‡ä»¶ä¸­ï¼Œåä¸ºQRCodeGenerator.javaçš„æ–‡ä»¶
public class QRCodeGenerator &#123;

    public static void main(String[] args) &#123;
        String text = &quot;Hello, World!&quot;;
        //ä¿®æ”¹widthå’Œheightå˜é‡æ¥è°ƒæ•´äºŒç»´ç çš„å°ºå¯¸
        int width = 300;
        int height = 300;
        //ä¿®æ”¹formatå˜é‡æ¥æŒ‡å®šä¿å­˜çš„å›¾ç‰‡æ ¼å¼
        String format = &quot;png&quot;;
        // è°ƒæ•´ç™½è¾¹çš„å®½åº¦
        int margin = 4;
        

        Map&lt;EncodeHintType, Object&gt; hints = new HashMap&lt;&gt;();
        hints.put(EncodeHintType.CHARACTER_SET, &quot;UTF-8&quot;);
        hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.L);

        try &#123;
            //åˆ›å»ºä¸€ä¸ªBitMatrixå¯¹è±¡å¹¶ä½¿ç”¨MultiFormatWriterç±»çš„encodeæ–¹æ³•ç”ŸæˆäºŒç»´ç çš„ä½çŸ©é˜µ
            BitMatrix bitMatrix = new MultiFormatWriter().encode(text,     BarcodeFormat.QR_CODE, width, height, hints);

            // è£å‰ªæ‰ç™½è¾¹
            int[] rec = bitMatrix.getEnclosingRectangle();
            int leftOffset = rec[0] - margin;
            int topOffset = rec[1] - margin;
            int newWidth = rec[2] + 2 * margin;
            int newHeight = rec[3] + 2 * margin;
            BitMatrix bitMatrixWithMargin = new BitMatrix(newWidth, newHeight);
            bitMatrixWithMargin.clear();
            //åœ¨æ–°çš„ä½çŸ©é˜µä¸­å¤åˆ¶ä½çŸ©é˜µçš„å†…å®¹
            for (int i = 0; i &lt; rec[2]; i++) &#123;
                for (int j = 0; j &lt; rec[3]; j++) &#123;
                    if (bitMatrix.get(i + leftOffset, j + topOffset)) &#123;
                        bitMatrixWithMargin.set(i + margin, j + margin);
                    &#125;
                &#125;
            &#125;

            //åˆ›å»ºBufferedImageå¯¹è±¡ï¼Œå¹¶æ ¹æ®ä½çŸ©é˜µçš„å€¼è®¾ç½®åƒç´ é¢œè‰²
            BufferedImage image = new BufferedImage(newWidth, newHeight, BufferedImage.TYPE_INT_RGB);
            for (int x = 0; x &lt; newWidth; x++) &#123;
                for (int y = 0; y &lt; newHeight; y++) &#123;
                    image.setRGB(x, y, bitMatrixWithMargin.get(x, y) ? 0xFF000000 : 0xFFFFFFFF);
                &#125;
            &#125;

            //ç”Ÿæˆçš„å›¾ç‰‡å°†ä¿å­˜åœ¨æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ä¸­
            File outputFile = new File(&quot;C:\\Users\\27694\\Desktop\\scarlet.png&quot;);
            ImageIO.write(image, format, outputFile);
            System.out.println(&quot;äºŒç»´ç ç”ŸæˆæˆåŠŸï¼&quot;); //å¦‚æœç”ŸæˆæˆåŠŸï¼Œæ§åˆ¶å°å°†è¾“å‡º&quot;äºŒç»´ç ç”ŸæˆæˆåŠŸï¼&quot;
        &#125; catch (Exception e) &#123;
            System.out.println(&quot;äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼š&quot; + e.getMessage()); //å¦‚æœç”Ÿæˆå¤±è´¥ï¼Œå°†è¾“å‡º&quot;äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼š&quot;åŠå¤±è´¥åŸå› 
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="ç”ŸæˆäºŒç»´ç å¹¶æ’å…¥word"><a href="#ç”ŸæˆäºŒç»´ç å¹¶æ’å…¥word" class="headerlink" title="ç”ŸæˆäºŒç»´ç å¹¶æ’å…¥word"></a>ç”ŸæˆäºŒç»´ç å¹¶æ’å…¥word</h3><pre><code class="java">//æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œä¸€ä¸ª XWPDFDocument å¯¹è±¡(Wordæ–‡æ¡£)ï¼Œä¸€ä¸ªå ä½ç¬¦å­—ç¬¦ä¸²å’Œä¸€ä¸ªäºŒç»´ç æ•°æ®å­—ç¬¦ä¸²
public static void insertQRCode(XWPFDocument doc, String placeholder, String qrCodeData) &#123;

        int margin = 1;
        // è°ƒæ•´ç™½è¾¹çš„å®½åº¦

        try &#123;
            //è®¾ç½®äºŒç»´ç ç”Ÿæˆçš„ä¸€äº›å‚æ•°
            Hashtable&lt;EncodeHintType, Object&gt; hintMap = new Hashtable&lt;&gt;();
            hintMap.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.L);

            //ç”ŸæˆäºŒç»´ç 
            QRCodeWriter qrCodeWriter = new QRCodeWriter();
            //å°†æ•°å­—å­—ç¬¦ä¸²è½¬æ¢ä¸ºBitMatrix
            BitMatrix bitMatrix = qrCodeWriter.encode(qrCodeData, BarcodeFormat.QR_CODE, 80, 80, hintMap);

            BufferedImage qrImage = MatrixToImageWriter.toBufferedImage(bitMatrix);
            BufferedImage croppedImage = qrImage.getSubimage(5, 5, 75, 75);//è°ƒæ•´ç™½è¾¹å®½åº¦

            ByteArrayOutputStream out = new ByteArrayOutputStream();
            ImageIO.write(croppedImage, &quot;png&quot;, out);

            XWPFParagraph paragraph = findParagraphByPlaceholder(doc, placeholder);
            // ç§»é™¤æ®µè½ä¸­çš„ç°æœ‰è¿è¡Œå…ƒç´ 
            if(paragraph != null) &#123;
                for (int i = paragraph.getRuns().size() - 1; i &gt;= 0; i--) &#123;
                    paragraph.removeRun(i);
                &#125;
            &#125;
            XWPFRun run = paragraph.createRun();


            run.addPicture(new ByteArrayInputStream(out.toByteArray()), XWPFDocument.PICTURE_TYPE_PNG, &quot;qrcode.png&quot;, Units.toEMU(80), Units.toEMU(80));

            // è®¾ç½®æ®µè½å¯¹é½æ–¹å¼ä¸ºå±…ä¸­
            paragraph.setAlignment(ParagraphAlignment.CENTER);

        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;
</code></pre>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå°†æ­¤ç±»æ–¹æ³•æ”¾å…¥<code>QRCodeUtils.java</code> æ–‡ä»¶ä¸­ï¼Œåœ¨é¡¹ç›®çš„å…¶ä»–ç±»ä¸­ï¼Œé€šè¿‡åˆ›å»º <code>QRCodeUtils</code> ç±»çš„å¯¹è±¡æ¥è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚</p>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-06-19</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« LiWenjing</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/Tech/'>
                            Tech
                        </a>
                    
                </span>
             
             
        
        </i>
    </div>
    
        

     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â© 1949-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠä¸€ç™¾å¹´åæ²¡æœ‰ä½ ä¹Ÿæ²¡æœ‰æˆ‘ğŸŒŠ</span>
            
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            
    
</div>


    
        
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/a11y-dark.min.css">

        
<script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlight.min.js"></script>

        
<script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js"></script>

    


<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>